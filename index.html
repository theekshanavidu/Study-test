document.getElementById("export-pdf").onclick = () => {
  const pdf = new jspdf.jsPDF('p', 'pt', 'a4'); // portrait, points
  const margin = 20;
  const pageWidth = pdf.internal.pageSize.getWidth();

  // ====== Table Data ======
  const tableData = [];
  hours.forEach((h, hourIndex) => {
    const row = [h];
    days.forEach((_, dayIndex) => {
      const val = document.getElementById(`tt_${dayIndex}_${hourIndex}`).value.trim();
      row.push(val || "");
    });
    tableData.push(row);
  });

  // ====== AutoTable ======
  pdf.autoTable({
    head: [['Hour', ...days]],
    body: tableData,
    theme: 'grid',
    styles: { fontSize: 10, cellPadding: 4 },
    headStyles: { fillColor: [30, 41, 59], textColor: 255 },
    alternateRowStyles: { fillColor: [240, 240, 240] },
    margin: { left: margin, right: margin },
  });

  // ====== Save PDF ======
  pdf.save(`timetable_${currentUser.uid}.pdf`);
};
